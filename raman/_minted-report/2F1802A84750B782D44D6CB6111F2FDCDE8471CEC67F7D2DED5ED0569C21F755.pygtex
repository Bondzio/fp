\begin{Verbatim}[commandchars=\\\{\}]
\PYGdefault{k+kn}{import} \PYGdefault{n+nn}{numpy} \PYGdefault{k+kn}{as} \PYGdefault{n+nn}{np}
\PYGdefault{k+kn}{from} \PYGdefault{n+nn}{scipy.optimize} \PYGdefault{k+kn}{import} \PYGdefault{n}{curve\PYGdefaultZus{}fit}
\PYGdefault{k+kn}{from} \PYGdefault{n+nn}{scipy.constants} \PYGdefault{k+kn}{import} \PYGdefault{n}{c}\PYGdefault{p}{,}\PYGdefault{n}{h}\PYGdefault{p}{,}\PYGdefault{n}{eV}\PYGdefault{p}{,} \PYGdefault{n}{pi}
\PYGdefault{k+kn}{from} \PYGdefault{n+nn}{smooth} \PYGdefault{k+kn}{import} \PYGdefault{n}{savitzky\PYGdefaultZus{}golay}
\PYGdefault{k+kn}{import} \PYGdefault{n+nn}{uncertainties} \PYGdefault{k+kn}{as} \PYGdefault{n+nn}{uc}
\PYGdefault{k+kn}{import} \PYGdefault{n+nn}{uncertainties.unumpy} \PYGdefault{k+kn}{as} \PYGdefault{n+nn}{un}
\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}./npy/\PYGdefaultZdq{}}

\PYGdefault{c}{\PYGdefaultZsh{} Functions for fitting}
\PYGdefault{k}{def} \PYGdefault{n+nf}{breit\PYGdefaultZus{}wigner}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{gamma}\PYGdefault{p}{,} \PYGdefault{n}{amplitude}\PYGdefault{p}{,} \PYGdefault{n}{offset}\PYGdefault{p}{):}
    \PYGdefault{l+s+sd}{\PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
\PYGdefault{l+s+sd}{    Breit\PYGdefaultZhy{}Wigner or Cauchy distribution with location parameter x0 }
\PYGdefault{l+s+sd}{    and scale parameter gamma = 0.5 * FWHM. Amplitude: 1 / (Pi * gamma). }
\PYGdefault{l+s+sd}{    No mean, variance or higher moments exist.}
\PYGdefault{l+s+sd}{    \PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
    \PYGdefault{k}{return} \PYGdefault{n}{amplitude} \PYGdefault{o}{/} \PYGdefault{p}{((}\PYGdefault{n}{pi}\PYGdefault{o}{*}\PYGdefault{n}{gamma}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{+} \PYGdefault{p}{((}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{x0}\PYGdefault{p}{)} \PYGdefault{o}{/} \PYGdefault{n}{gamma}\PYGdefault{p}{)}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{))} \PYGdefault{o}{+} \PYGdefault{n}{offset}
   
\PYGdefault{k}{def} \PYGdefault{n+nf}{bw\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{):}
    \PYGdefault{n}{x\PYGdefaultZus{}min}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}max} \PYGdefault{o}{=} \PYGdefault{n}{x\PYGdefaultZus{}range}
    \PYGdefault{n}{mask} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZgt{}} \PYGdefault{n}{x\PYGdefaultZus{}min}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{x\PYGdefaultZus{}max}\PYGdefault{p}{)}
    \PYGdefault{n}{x\PYGdefaultZus{}fit} \PYGdefault{o}{=} \PYGdefault{n}{x}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{]}
    \PYGdefault{n}{y\PYGdefaultZus{}fit} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{nominal\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{])}
    \PYGdefault{n}{y\PYGdefaultZus{}sigma} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sqrt}\PYGdefault{p}{(}\PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{std\PYGdefaultZus{}devs}\PYGdefault{p}{(}\PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{]))}
    \PYGdefault{k}{if} \PYGdefault{n}{fit}\PYGdefault{p}{:}
        \PYGdefault{n}{coeff}\PYGdefault{p}{,} \PYGdefault{n}{cov} \PYGdefault{o}{=} \PYGdefault{n}{curve\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{breit\PYGdefaultZus{}wigner}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{o}{=}\PYGdefault{n}{p0}\PYGdefault{p}{,} 
                                  \PYGdefault{n}{sigma}\PYGdefault{o}{=}\PYGdefault{n}{y\PYGdefaultZus{}sigma}\PYGdefault{p}{,} \PYGdefault{n}{absolute\PYGdefaultZus{}sigma}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
        \PYGdefault{n}{c} \PYGdefault{o}{=} \PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{correlated\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{coeff}\PYGdefault{p}{,} \PYGdefault{n}{cov}\PYGdefault{p}{)}
        \PYGdefault{n}{fit\PYGdefaultZus{}peak} \PYGdefault{o}{=} \PYGdefault{n}{breit\PYGdefaultZus{}wigner}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{coeff}\PYGdefault{p}{)}
    \PYGdefault{k}{else}\PYGdefault{p}{:}
        \PYGdefault{n}{fit\PYGdefaultZus{}peak} \PYGdefault{o}{=} \PYGdefault{n}{breit\PYGdefaultZus{}wigner}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{p0}\PYGdefault{p}{)}
        \PYGdefault{n}{c} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{uarray}\PYGdefault{p}{(}\PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
    \PYGdefault{k}{return} \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak}\PYGdefault{p}{,} \PYGdefault{n}{c}

\PYGdefault{k}{def} \PYGdefault{n+nf}{gauss}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{sigma}\PYGdefault{p}{,} \PYGdefault{n}{amplitude}\PYGdefault{p}{,} \PYGdefault{n}{offset}\PYGdefault{p}{):}
    \PYGdefault{l+s+sd}{\PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
\PYGdefault{l+s+sd}{    Gauss peak plus offset}
\PYGdefault{l+s+sd}{    \PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
    \PYGdefault{k}{return} \PYGdefault{n}{amplitude} \PYGdefault{o}{/} \PYGdefault{p}{(}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sqrt}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{2} \PYGdefault{o}{*} \PYGdefault{n}{pi}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{n}{sigma}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{exp}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{)}\PYGdefault{o}{**}\PYGdefault{p}{(}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{x0}\PYGdefault{p}{)}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{2} \PYGdefault{o}{/} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{2} \PYGdefault{o}{*} \PYGdefault{n}{sigma}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{))} \PYGdefault{o}{+} \PYGdefault{n}{offset}
   
\PYGdefault{k}{def} \PYGdefault{n+nf}{gauss\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{):}
    \PYGdefault{n}{x\PYGdefaultZus{}min}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}max} \PYGdefault{o}{=} \PYGdefault{n}{x\PYGdefaultZus{}range}
    \PYGdefault{n}{mask} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZgt{}} \PYGdefault{n}{x\PYGdefaultZus{}min}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{x\PYGdefaultZus{}max}\PYGdefault{p}{)}
    \PYGdefault{n}{x\PYGdefaultZus{}fit} \PYGdefault{o}{=} \PYGdefault{n}{x}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{]}
    \PYGdefault{n}{y\PYGdefaultZus{}fit} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{nominal\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{])}
    \PYGdefault{n}{y\PYGdefaultZus{}sigma} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sqrt}\PYGdefault{p}{(}\PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{std\PYGdefaultZus{}devs}\PYGdefault{p}{(}\PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{]))}
    \PYGdefault{k}{if} \PYGdefault{n}{fit}\PYGdefault{p}{:}
        \PYGdefault{n}{coeff}\PYGdefault{p}{,} \PYGdefault{n}{cov} \PYGdefault{o}{=} \PYGdefault{n}{curve\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{gauss}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{o}{=}\PYGdefault{n}{p0}\PYGdefault{p}{,} 
                                  \PYGdefault{n}{sigma}\PYGdefault{o}{=}\PYGdefault{n}{y\PYGdefaultZus{}sigma}\PYGdefault{p}{,} \PYGdefault{n}{absolute\PYGdefaultZus{}sigma}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
        \PYGdefault{n}{c} \PYGdefault{o}{=} \PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{correlated\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{coeff}\PYGdefault{p}{,} \PYGdefault{n}{cov}\PYGdefault{p}{)}
        \PYGdefault{n}{fit\PYGdefaultZus{}peak} \PYGdefault{o}{=} \PYGdefault{n}{gauss}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{coeff}\PYGdefault{p}{)}
    \PYGdefault{k}{else}\PYGdefault{p}{:}
        \PYGdefault{n}{fit\PYGdefaultZus{}peak} \PYGdefault{o}{=} \PYGdefault{n}{gauss}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{p0}\PYGdefault{p}{)}
        \PYGdefault{n}{c} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{uarray}\PYGdefault{p}{(}\PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
    \PYGdefault{k}{return} \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak}\PYGdefault{p}{,} \PYGdefault{n}{c}

\PYGdefault{k}{def} \PYGdefault{n+nf}{two\PYGdefaultZus{}breit\PYGdefaultZus{}wigner}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{gamma}\PYGdefault{p}{,} \PYGdefault{n}{amplitude}\PYGdefault{p}{,} \PYGdefault{n}{x02}\PYGdefault{p}{,} \PYGdefault{n}{gamma2}\PYGdefault{p}{,} \PYGdefault{n}{amplitude2}\PYGdefault{p}{,} \PYGdefault{n}{offset}\PYGdefault{p}{):}
    \PYGdefault{n}{tbw} \PYGdefault{o}{=} \PYGdefault{n}{amplitude} \PYGdefault{o}{/} \PYGdefault{p}{((}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{pi}\PYGdefault{o}{*}\PYGdefault{n}{gamma}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{+} \PYGdefault{p}{((}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{x0}\PYGdefault{p}{)} \PYGdefault{o}{/} \PYGdefault{n}{gamma}\PYGdefault{p}{)}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{))} \PYGdefault{o}{+} \PYGdefaultZbs{}
    \PYGdefault{n}{amplitude2} \PYGdefault{o}{/} \PYGdefault{p}{((}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{pi}\PYGdefault{o}{*}\PYGdefault{n}{gamma2}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{+} \PYGdefault{p}{((}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{x02}\PYGdefault{p}{)} \PYGdefault{o}{/} \PYGdefault{n}{gamma2}\PYGdefault{p}{)}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{))} \PYGdefault{o}{+} \PYGdefault{n}{offset}
    \PYGdefault{k}{return} \PYGdefault{n}{tbw}

\PYGdefault{k}{def} \PYGdefault{n+nf}{two\PYGdefaultZus{}bw\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{):}
    \PYGdefault{n}{x\PYGdefaultZus{}min}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}max} \PYGdefault{o}{=} \PYGdefault{n}{x\PYGdefaultZus{}range}
    \PYGdefault{n}{mask} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZgt{}} \PYGdefault{n}{x\PYGdefaultZus{}min}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{x\PYGdefaultZus{}max}\PYGdefault{p}{)}
    \PYGdefault{n}{x\PYGdefaultZus{}fit} \PYGdefault{o}{=} \PYGdefault{n}{x}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{]}
    \PYGdefault{n}{y\PYGdefaultZus{}fit} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{nominal\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{])}
    \PYGdefault{n}{y\PYGdefaultZus{}sigma} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sqrt}\PYGdefault{p}{(}\PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{std\PYGdefaultZus{}devs}\PYGdefault{p}{(}\PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{]))}
    \PYGdefault{k}{if} \PYGdefault{n}{fit}\PYGdefault{p}{:}
        \PYGdefault{n}{coeff}\PYGdefault{p}{,} \PYGdefault{n}{cov} \PYGdefault{o}{=} \PYGdefault{n}{curve\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{two\PYGdefaultZus{}breit\PYGdefaultZus{}wigner}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{o}{=}\PYGdefault{n}{p0}\PYGdefault{p}{,} 
                                  \PYGdefault{n}{sigma}\PYGdefault{o}{=}\PYGdefault{n}{y\PYGdefaultZus{}sigma}\PYGdefault{p}{,} \PYGdefault{n}{absolute\PYGdefaultZus{}sigma}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
        \PYGdefault{n}{c} \PYGdefault{o}{=} \PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{correlated\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{coeff}\PYGdefault{p}{,} \PYGdefault{n}{cov}\PYGdefault{p}{)}
        \PYGdefault{n}{fit\PYGdefaultZus{}peak} \PYGdefault{o}{=} \PYGdefault{n}{two\PYGdefaultZus{}breit\PYGdefaultZus{}wigner}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{coeff}\PYGdefault{p}{)}
    \PYGdefault{k}{else}\PYGdefault{p}{:}
        \PYGdefault{n}{fit\PYGdefaultZus{}peak} \PYGdefault{o}{=} \PYGdefault{n}{two\PYGdefaultZus{}breit\PYGdefaultZus{}wigner}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{p0}\PYGdefault{p}{)}
        \PYGdefault{n}{c} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{uarray}\PYGdefault{p}{(}\PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
    \PYGdefault{k}{return} \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak}\PYGdefault{p}{,} \PYGdefault{n}{c}

\PYGdefault{k}{def} \PYGdefault{n+nf}{poly}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{p1}\PYGdefault{p}{,} \PYGdefault{n}{p2}\PYGdefault{p}{,} \PYGdefault{n}{p3}\PYGdefault{p}{,} \PYGdefault{n}{p4}\PYGdefault{p}{):}
    \PYGdefault{n}{x\PYGdefaultZus{}p} \PYGdefault{o}{=} \PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{540} \PYGdefault{c}{\PYGdefaultZsh{} move x value near the points to be fitted}
    \PYGdefault{k}{return} \PYGdefault{n}{p0}\PYGdefault{o}{*}\PYGdefault{n}{x\PYGdefaultZus{}p}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{4} \PYGdefault{o}{+} \PYGdefault{n}{p1}\PYGdefault{o}{*}\PYGdefault{n}{x\PYGdefaultZus{}p}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{3} \PYGdefault{o}{+} \PYGdefault{n}{p2}\PYGdefault{o}{*}\PYGdefault{n}{x\PYGdefaultZus{}p}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{2} \PYGdefault{o}{+} \PYGdefault{n}{p3}\PYGdefault{o}{*}\PYGdefault{n}{x\PYGdefaultZus{}p} \PYGdefault{o}{+} \PYGdefault{n}{p4}

\PYGdefault{k}{def} \PYGdefault{n+nf}{poly\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{):}
    \PYGdefault{n}{x\PYGdefaultZus{}min}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}max} \PYGdefault{o}{=} \PYGdefault{n}{x\PYGdefaultZus{}range}
    \PYGdefault{n}{mask} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZgt{}} \PYGdefault{n}{x\PYGdefaultZus{}min}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{x\PYGdefaultZus{}max}\PYGdefault{p}{)}
    \PYGdefault{n}{x\PYGdefaultZus{}fit} \PYGdefault{o}{=} \PYGdefault{n}{x}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{]}
    \PYGdefault{n}{y\PYGdefaultZus{}fit} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{nominal\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{])}
    \PYGdefault{n}{y\PYGdefaultZus{}sigma} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sqrt}\PYGdefault{p}{(}\PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{std\PYGdefaultZus{}devs}\PYGdefault{p}{(}\PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{[}\PYGdefault{n}{mask}\PYGdefault{p}{]))}
    \PYGdefault{n}{coeff}\PYGdefault{p}{,} \PYGdefault{n}{cov} \PYGdefault{o}{=} \PYGdefault{n}{curve\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{poly}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{o}{=}\PYGdefault{n}{p0}\PYGdefault{p}{,} 
                           \PYGdefault{n}{sigma}\PYGdefault{o}{=}\PYGdefault{n}{y\PYGdefaultZus{}sigma}\PYGdefault{p}{,} \PYGdefault{n}{absolute\PYGdefaultZus{}sigma}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
    \PYGdefault{n}{c} \PYGdefault{o}{=} \PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{correlated\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{coeff}\PYGdefault{p}{,} \PYGdefault{n}{cov}\PYGdefault{p}{)}
    \PYGdefault{k}{return} \PYGdefault{n}{c}

\PYGdefault{k}{def} \PYGdefault{n+nf}{linear}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{a}\PYGdefault{p}{,} \PYGdefault{n}{b}\PYGdefault{p}{):}
    \PYGdefault{k}{return} \PYGdefault{p}{(}\PYGdefault{n}{a}\PYGdefault{o}{*}\PYGdefault{n}{x} \PYGdefault{o}{+} \PYGdefault{n}{b}\PYGdefault{p}{)}

\PYGdefault{c}{\PYGdefaultZsh{} Further functions conveniently defined}
\PYGdefault{k}{def} \PYGdefault{n+nf}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{c}\PYGdefault{p}{,} \PYGdefault{n}{max\PYGdefaultZus{}digit}\PYGdefault{o}{=}\PYGdefault{l+m+mi}{4}\PYGdefault{p}{):}
    \PYGdefault{l+s+sd}{\PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
\PYGdefault{l+s+sd}{    input format: uc.ufloat}
\PYGdefault{l+s+sd}{    rounds float and corrisponding error to last significant digit}
\PYGdefault{l+s+sd}{    returns float and error as string}
\PYGdefault{l+s+sd}{    as integers with max 4 error digits}
\PYGdefault{l+s+sd}{    as floats with max max\PYGdefaultZus{}digit (=4) error digits}
\PYGdefault{l+s+sd}{    as exp else}
\PYGdefault{l+s+sd}{    \PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
    \PYGdefault{n}{digit} \PYGdefault{o}{=} \PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{n+nb}{int}\PYGdefault{p}{(}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{floor}\PYGdefault{p}{(}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{log10}\PYGdefault{p}{(}\PYGdefault{n}{c}\PYGdefault{o}{.}\PYGdefault{n}{s}\PYGdefault{p}{)))}    
    \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{c}\PYGdefault{o}{.}\PYGdefault{n}{s} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{n}{digit}\PYGdefault{p}{)} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{l+m+mf}{1.5}\PYGdefault{p}{:} \PYGdefault{c}{\PYGdefaultZsh{} convention...}
        \PYGdefault{n}{digit} \PYGdefault{o}{+=} \PYGdefault{l+m+mi}{1}
    \PYGdefault{n}{c\PYGdefaultZus{}r} \PYGdefault{o}{=} \PYGdefault{n+nb}{round}\PYGdefault{p}{(}\PYGdefault{n}{c}\PYGdefault{o}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{digit}\PYGdefault{p}{)}
    \PYGdefault{n}{s\PYGdefaultZus{}c\PYGdefaultZus{}r} \PYGdefault{o}{=} \PYGdefault{n+nb}{round}\PYGdefault{p}{(}\PYGdefault{n}{c}\PYGdefault{o}{.}\PYGdefault{n}{s}\PYGdefault{p}{,} \PYGdefault{n}{digit}\PYGdefault{p}{)}
    \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{3} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{digit}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{digit} \PYGdefault{o}{\PYGdefaultZlt{}=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{):} \PYGdefault{c}{\PYGdefaultZsh{} returns readable integers}
        \PYGdefault{n}{c\PYGdefaultZus{}str} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{ \PYGdefaultZbs{}pm }\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}\PYGdefault{n}{c\PYGdefaultZus{}r}\PYGdefault{p}{,} \PYGdefault{n}{s\PYGdefaultZus{}c\PYGdefaultZus{}r}\PYGdefault{p}{)}
    \PYGdefault{k}{elif} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{0} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{digit}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{digit} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{p}{(}\PYGdefault{n}{max\PYGdefaultZus{}digit} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{)):} \PYGdefault{c}{\PYGdefaultZsh{} returns readable floats (max 3 digits)}
        \PYGdefault{n}{c\PYGdefaultZus{}str} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}\PYGdefaultZpc{}.\PYGdefaultZsq{}} \PYGdefault{o}{+} \PYGdefault{n+nb}{str}\PYGdefault{p}{(}\PYGdefault{n}{digit}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}f \PYGdefaultZbs{}pm \PYGdefaultZpc{}.\PYGdefaultZsq{}} \PYGdefault{o}{+} \PYGdefault{n+nb}{str}\PYGdefault{p}{(}\PYGdefault{n}{digit}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}f\PYGdefaultZsq{}}\PYGdefault{p}{)}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}\PYGdefault{n}{c\PYGdefaultZus{}r}\PYGdefault{p}{,} \PYGdefault{n}{s\PYGdefaultZus{}c\PYGdefaultZus{}r}\PYGdefault{p}{)}
    \PYGdefault{k}{else}\PYGdefault{p}{:} \PYGdefault{c}{\PYGdefaultZsh{} returns exp}
        \PYGdefault{n}{c\PYGdefaultZus{}str} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}(}\PYGdefault{l+s+si}{\PYGdefaultZpc{}.1f}\PYGdefault{l+s}{ \PYGdefaultZbs{}pm }\PYGdefault{l+s+si}{\PYGdefaultZpc{}.1f}\PYGdefault{l+s}{)\PYGdefaultZbs{}mathrm\PYGdefaultZob{}e\PYGdefaultZcb{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{p}{)}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}\PYGdefault{n}{c\PYGdefaultZus{}r} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{p}{(}\PYGdefault{n}{digit}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{),} \PYGdefault{n}{s\PYGdefaultZus{}c\PYGdefaultZus{}r} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{p}{(}\PYGdefault{n}{digit}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{),} \PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{p}{(}\PYGdefault{n}{digit}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{))}
    \PYGdefault{k}{return} \PYGdefault{n}{c\PYGdefaultZus{}str}

\PYGdefault{k}{def} \PYGdefault{n+nf}{enum}\PYGdefault{p}{(}\PYGdefault{n}{arr1}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{args}\PYGdefault{p}{):}
    \PYGdefault{l+s+sd}{\PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
\PYGdefault{l+s+sd}{    Combines enumerate and zip.}
\PYGdefault{l+s+sd}{    \PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
    \PYGdefault{n}{i\PYGdefaultZus{}range} \PYGdefault{o}{=} \PYGdefault{n+nb}{range}\PYGdefault{p}{(}\PYGdefault{n+nb}{len}\PYGdefault{p}{(}\PYGdefault{n}{arr1}\PYGdefault{p}{))}
    \PYGdefault{k}{return} \PYGdefault{n+nb}{zip}\PYGdefault{p}{(}\PYGdefault{n}{i\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{arr1} \PYGdefault{p}{,}\PYGdefault{o}{*}\PYGdefault{n}{args}\PYGdefault{p}{)}

\PYGdefault{c}{\PYGdefaultZsh{} RAMAN SPECIFIC}
\PYGdefault{k}{def} \PYGdefault{n+nf}{t\PYGdefaultZus{}avg}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{):}
    \PYGdefault{l+s+sd}{\PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
\PYGdefault{l+s+sd}{    Get integration time and number of measurements}
\PYGdefault{l+s+sd}{    \PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
    \PYGdefault{n}{f} \PYGdefault{o}{=} \PYGdefault{n+nb}{open}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}data/\PYGdefaultZdq{}} \PYGdefault{o}{+} \PYGdefault{n}{filename} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZdq{}.txt\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{encoding}\PYGdefault{o}{=}\PYGdefault{l+s}{\PYGdefaultZsq{}cp1252\PYGdefaultZsq{}}\PYGdefault{p}{)}
    \PYGdefault{n}{lines} \PYGdefault{o}{=} \PYGdefault{n}{f}\PYGdefault{o}{.}\PYGdefault{n}{readlines}\PYGdefault{p}{()}
    \PYGdefault{n}{f}\PYGdefault{o}{.}\PYGdefault{n}{close}\PYGdefault{p}{()}
    \PYGdefault{n}{t} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{float}\PYGdefault{p}{(}\PYGdefault{n}{lines}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{8}\PYGdefault{p}{]}\PYGdefault{o}{.}\PYGdefault{n}{split}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{} \PYGdefaultZsq{}}\PYGdefault{p}{)[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{l+m+mf}{1e\PYGdefaultZhy{}6} \PYGdefault{c}{\PYGdefaultZsh{} measured time in sec}
    \PYGdefault{n}{avg} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{float}\PYGdefault{p}{(}\PYGdefault{n}{lines}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{9}\PYGdefault{p}{]}\PYGdefault{o}{.}\PYGdefault{n}{split}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{} \PYGdefaultZsq{}}\PYGdefault{p}{)[}\PYGdefault{l+m+mi}{3}\PYGdefault{p}{])} \PYGdefault{c}{\PYGdefaultZsh{} number of recording to take average from}
    \PYGdefault{k}{return} \PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}

\PYGdefault{k}{def} \PYGdefault{n+nf}{lamb\PYGdefaultZus{}to\PYGdefaultZus{}cm}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}stokes}\PYGdefault{p}{):}
    \PYGdefault{l+s+sd}{\PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
\PYGdefault{l+s+sd}{    Converts Raman peaks in nm into wavenumber (in cm\PYGdefaultZca{}\PYGdefaultZhy{}1) of corresponding vibrational mode}
\PYGdefault{l+s+sd}{    \PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
    \PYGdefault{c}{\PYGdefaultZsh{}lamb\PYGdefaultZus{}laser = 532 \PYGdefaultZsh{} nm, Nd:Yag frequency doubled}
    \PYGdefault{n}{lamb\PYGdefaultZus{}laser} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}lamb\PYGdefaultZus{}laser.npy\PYGdefaultZsq{}}\PYGdefault{p}{)[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{c}{\PYGdefaultZsh{} measured laser wavelength}
    \PYGdefault{n}{dnu\PYGdefaultZus{}cm} \PYGdefault{o}{=} \PYGdefault{n+nb}{abs}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}laser} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}stokes}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{7}
    \PYGdefault{k}{return}\PYGdefault{p}{(}\PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{)}

\PYGdefault{k}{def} \PYGdefault{n+nf}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}data}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{):}
    \PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg} \PYGdefault{o}{=} \PYGdefault{n}{t\PYGdefaultZus{}avg}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
    \PYGdefault{n}{x} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}npy/\PYGdefaultZdq{}}\PYGdefault{o}{+}\PYGdefault{n}{filename}\PYGdefault{o}{+}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZus{}lamb.npy\PYGdefaultZdq{}}\PYGdefault{p}{)}
    \PYGdefault{n}{y} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}npy/\PYGdefaultZdq{}}\PYGdefault{o}{+}\PYGdefault{n}{filename}\PYGdefault{o}{+}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZus{}count.npy\PYGdefaultZdq{}}\PYGdefault{p}{)}
    \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{uarray}\PYGdefault{p}{(}\PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{maximum}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sqrt}\PYGdefault{p}{(}\PYGdefault{n}{y} \PYGdefault{o}{/} \PYGdefault{n}{avg}\PYGdefault{p}{)))}
    \PYGdefault{k}{return} \PYGdefault{p}{(}\PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{)}


\PYGdefault{k}{def} \PYGdefault{n+nf}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}rate}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{):}
    \PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg} \PYGdefault{o}{=} \PYGdefault{n}{t\PYGdefaultZus{}avg}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
    \PYGdefault{n}{x} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}npy/\PYGdefaultZdq{}}\PYGdefault{o}{+}\PYGdefault{n}{filename}\PYGdefault{o}{+}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZus{}lamb.npy\PYGdefaultZdq{}}\PYGdefault{p}{)}
    \PYGdefault{n}{y} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}npy/\PYGdefaultZdq{}}\PYGdefault{o}{+}\PYGdefault{n}{filename}\PYGdefault{o}{+}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZus{}count.npy\PYGdefaultZdq{}}\PYGdefault{p}{)}
    \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{uarray}\PYGdefault{p}{(}\PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{maximum}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sqrt}\PYGdefault{p}{(}\PYGdefault{n}{y} \PYGdefault{o}{/} \PYGdefault{n}{avg}\PYGdefault{p}{)))}
    \PYGdefault{c}{\PYGdefaultZsh{} transform to rates}
    \PYGdefault{n}{rate\PYGdefaultZus{}bg} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}rate\PYGdefaultZus{}bg.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} background rates}
    \PYGdefault{n}{rate\PYGdefaultZus{}bg\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}rate\PYGdefaultZus{}bg\PYGdefaultZus{}e.npy\PYGdefaultZsq{}}\PYGdefault{p}{)}
    \PYGdefault{n}{rate} \PYGdefault{o}{=} \PYGdefault{n}{y} \PYGdefault{o}{/} \PYGdefault{n}{t} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{rate\PYGdefaultZus{}bg}
    \PYGdefault{n}{rate\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{/} \PYGdefault{n}{t} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{rate\PYGdefaultZus{}bg\PYGdefaultZus{}e}
    \PYGdefault{k}{return} \PYGdefault{p}{(}\PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{rate}\PYGdefault{p}{,} \PYGdefault{n}{rate\PYGdefaultZus{}e}\PYGdefault{p}{)}

\PYGdefault{k}{def} \PYGdefault{n+nf}{rm\PYGdefaultZus{}outliers}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{n}\PYGdefault{o}{=}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{):}
    \PYGdefault{l+s+sd}{\PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
\PYGdefault{l+s+sd}{    Remove outliers identified by largest absolute value of }
\PYGdefault{l+s+sd}{    difference between point and its two neighbors.}
\PYGdefault{l+s+sd}{    These are defects of the CCD}
\PYGdefault{l+s+sd}{    \PYGdefaultZdq{}\PYGdefaultZdq{}\PYGdefaultZdq{}}
    \PYGdefault{k}{for} \PYGdefault{n}{j} \PYGdefault{o+ow}{in} \PYGdefault{n+nb}{range}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{):}
        \PYGdefault{n}{out} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{argmax}\PYGdefault{p}{(}\PYGdefault{n+nb}{abs}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{2} \PYGdefault{o}{*} \PYGdefault{n}{y}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{:}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{y}\PYGdefault{p}{[:}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{y}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{:]))} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{1}
        \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{delete}\PYGdefault{p}{([}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{],} \PYGdefault{n}{out}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{)}
        \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{delete}\PYGdefault{p}{(}\PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{out}\PYGdefault{p}{)}
    \PYGdefault{k}{return}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{)}

\PYGdefault{c}{\PYGdefaultZsh{} Calibration}
\PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}hg\PYGdefaultZus{}00\PYGdefaultZdq{}}
\PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}data}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
\PYGdefault{n}{As} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{x0s} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{c}{\PYGdefaultZsh{} Fit ranges and initial guesses}
\PYGdefault{c}{\PYGdefaultZsh{} p = [x0, gamma, amplitude, offset]}
\PYGdefault{n}{x\PYGdefaultZus{}ranges} \PYGdefault{o}{=} \PYGdefault{p}{[[}\PYGdefault{l+m+mi}{420}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{450}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{520}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{560}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{565}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{578}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{578}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{585}\PYGdefault{p}{]]}
\PYGdefault{n}{p0s} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([[}\PYGdefault{l+m+mi}{435}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{14000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{545}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{40000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} 
               \PYGdefault{p}{[}\PYGdefault{l+m+mi}{577}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{5000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{579}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{5000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{]])}
\PYGdefault{n}{labels} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}435.8 nm\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}546.1 nm\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}577.1 nm\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}579.1 nm\PYGdefaultZsq{}}\PYGdefault{p}{]}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{label} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}ranges}\PYGdefault{p}{,} \PYGdefault{n}{p0s}\PYGdefault{p}{,} \PYGdefault{n}{labels}\PYGdefault{p}{):}
    \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak}\PYGdefault{p}{,} \PYGdefault{n}{c1} \PYGdefault{o}{=} \PYGdefault{n}{bw\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
    \PYGdefault{n}{x0s}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
    \PYGdefault{n}{As}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{])}
\PYGdefault{n}{lits} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+m+mf}{435.8}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{546.1}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{577.1}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{579.1}\PYGdefault{p}{]}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{lit} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{x0s}\PYGdefault{p}{,} \PYGdefault{n}{lits}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZbs{}cellcolor\PYGdefaultZob{}LightCyan\PYGdefaultZcb{}\PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}.1f}\PYGdefault{l+s}{\PYGdefaultZdl{}   }\PYGdefault{l+s+se}{\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}
            \PYGdefault{n}{i}\PYGdefault{o}{+}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{x0}\PYGdefault{p}{),} \PYGdefault{n}{lit}\PYGdefault{p}{))}
\PYGdefault{c}{\PYGdefaultZsh{} Linear fit on peaks }
\PYGdefault{n}{x0} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{nominal\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{x0s}\PYGdefault{p}{)}
\PYGdefault{n}{s\PYGdefaultZus{}x0} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{std\PYGdefaultZus{}devs}\PYGdefault{p}{(}\PYGdefault{n}{x0s}\PYGdefault{p}{)}
\PYGdefault{n}{lit\PYGdefaultZus{}peaks} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+m+mf}{435.8}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{546.1}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{577.1}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{579.1}\PYGdefault{p}{])}
\PYGdefault{n}{coeff\PYGdefaultZus{}lin}\PYGdefault{p}{,} \PYGdefault{n}{cov\PYGdefaultZus{}lin} \PYGdefault{o}{=} \PYGdefault{n}{curve\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{linear}\PYGdefault{p}{,} \PYGdefault{n}{lit\PYGdefaultZus{}peaks}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{None}\PYGdefault{p}{,} 
                               \PYGdefault{n}{sigma}\PYGdefault{o}{=}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sqrt}\PYGdefault{p}{(}\PYGdefault{n}{s\PYGdefaultZus{}x0}\PYGdefault{p}{),} \PYGdefault{n}{absolute\PYGdefaultZus{}sigma}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
\PYGdefault{n}{c\PYGdefaultZus{}lin} \PYGdefault{o}{=} \PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{correlated\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{coeff\PYGdefaultZus{}lin}\PYGdefault{p}{,} \PYGdefault{n}{cov\PYGdefaultZus{}lin}\PYGdefault{p}{)}
\PYGdefault{c}{\PYGdefaultZsh{} Switch to lambda(x0) = lit\PYGdefaultZus{}peak(x0)}
\PYGdefault{n}{d\PYGdefaultZus{}lin} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{c\PYGdefaultZus{}lin}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} \PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{n}{c\PYGdefaultZus{}lin}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{/} \PYGdefault{n}{c\PYGdefaultZus{}lin}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]])}
\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{save}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}calibration\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{d\PYGdefaultZus{}lin}\PYGdefault{p}{)}

\PYGdefault{c}{\PYGdefaultZsh{} Detection probability}
\PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}white\PYGdefaultZus{}pol0\PYGdefaultZdq{}}
\PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y0}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e0} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}data}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
\PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}white\PYGdefaultZus{}pol45\PYGdefaultZdq{}}
\PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y45}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e45} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}data}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
\PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}white\PYGdefaultZus{}pol90\PYGdefaultZdq{}}
\PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y90}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e90} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}data}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
\PYGdefault{c}{\PYGdefaultZsh{} Correlation factor:}
\PYGdefault{n}{corr0}  \PYGdefault{o}{=} \PYGdefault{n}{y45} \PYGdefault{o}{/} \PYGdefault{n}{y0}
\PYGdefault{n}{corr90} \PYGdefault{o}{=} \PYGdefault{n}{y45} \PYGdefault{o}{/} \PYGdefault{n}{y90}
\PYGdefault{c}{\PYGdefaultZsh{} remove one outlier:}
\PYGdefault{n}{mstep} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{argmin}\PYGdefault{p}{(}\PYGdefault{n}{corr0}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{:]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{corr0}\PYGdefault{p}{[:}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{1} \PYGdefault{c}{\PYGdefaultZsh{} find the outlier}
\PYGdefault{n}{n} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{20}
\PYGdefault{n}{low} \PYGdefault{o}{=} \PYGdefault{n}{corr0}\PYGdefault{p}{[}\PYGdefault{n}{mstep} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{n}\PYGdefault{p}{:} \PYGdefault{n}{mstep}\PYGdefault{p}{]}
\PYGdefault{n}{up} \PYGdefault{o}{=} \PYGdefault{n}{corr0}\PYGdefault{p}{[}\PYGdefault{n}{mstep} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{:} \PYGdefault{n}{mstep} \PYGdefault{o}{+} \PYGdefault{n}{n} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{]}
\PYGdefault{n}{corr\PYGdefaultZus{}avg} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{mean}\PYGdefault{p}{(}\PYGdefault{n}{low} \PYGdefault{o}{+} \PYGdefault{n}{up}\PYGdefault{p}{)} \PYGdefault{o}{/} \PYGdefault{l+m+mi}{2} 
\PYGdefault{n}{corr0}\PYGdefault{p}{[}\PYGdefault{n}{mstep}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{corr\PYGdefaultZus{}avg} \PYGdefault{c}{\PYGdefaultZsh{} replace it by the mean of the n values in both directions}
\PYGdefault{c}{\PYGdefaultZsh{} Filter data:}
\PYGdefault{n}{n\PYGdefaultZus{}sav} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{301} \PYGdefault{c}{\PYGdefaultZsh{} number of data point for savitzki\PYGdefaultZhy{}golay filter}
\PYGdefault{n}{corr0\PYGdefaultZus{}fil} \PYGdefault{o}{=} \PYGdefault{n}{savitzky\PYGdefaultZus{}golay}\PYGdefault{p}{(}\PYGdefault{n}{corr0}\PYGdefault{p}{,} \PYGdefault{n}{n\PYGdefaultZus{}sav}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{4}\PYGdefault{p}{)}
\PYGdefault{n}{corr90\PYGdefaultZus{}fil} \PYGdefault{o}{=} \PYGdefault{n}{savitzky\PYGdefaultZus{}golay}\PYGdefault{p}{(}\PYGdefault{n}{corr90}\PYGdefault{p}{,} \PYGdefault{n}{n\PYGdefaultZus{}sav}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{4}\PYGdefault{p}{)}
\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{save}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}corr0\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{corr0\PYGdefaultZus{}fil}\PYGdefault{p}{)}
\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{save}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}corr90\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{corr90\PYGdefaultZus{}fil}\PYGdefault{p}{)}

\PYGdefault{c}{\PYGdefaultZsh{} Analyzing the laser}
\PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}laser\PYGdefaultZus{}ccl4\PYGdefaultZus{}00\PYGdefaultZdq{}}
\PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}data}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
\PYGdefault{c}{\PYGdefaultZsh{} Fitting}
\PYGdefault{c}{\PYGdefaultZsh{} p = [x0, sigma, amplitude, offset]}
\PYGdefault{n}{x\PYGdefaultZus{}range} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{510}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{550}\PYGdefault{p}{]}   \PYGdefault{c}{\PYGdefaultZsh{} lower and upper bound}
\PYGdefault{n}{p0} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+m+mi}{531}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.4}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{27000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1420}\PYGdefault{p}{])}
\PYGdefault{n}{x\PYGdefaultZus{}fit1}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak1}\PYGdefault{p}{,} \PYGdefault{n}{c1} \PYGdefault{o}{=} \PYGdefault{n}{gauss\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
\PYGdefault{n}{x0} \PYGdefault{o}{=} \PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{ufloat}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}\PYGdefault{o}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]}\PYGdefault{o}{.}\PYGdefault{n}{n}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} choose sigma as error on laser wavelength!}
\PYGdefault{n}{lamb\PYGdefaultZus{}laser} \PYGdefault{o}{=} \PYGdefault{n}{linear}\PYGdefault{p}{(}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{n}{x0}\PYGdefault{p}{]),} \PYGdefault{o}{*}\PYGdefault{n}{d\PYGdefaultZus{}lin}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Correct for calibration}
\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{save}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}lamb\PYGdefaultZus{}laser\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{lamb\PYGdefaultZus{}laser}\PYGdefault{p}{)}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}laser}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]))}

\PYGdefault{c}{\PYGdefaultZsh{} Notch filter}
\PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}white\PYGdefaultZus{}notch\PYGdefaultZdq{}}
\PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}notch}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}data}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
\PYGdefault{c}{\PYGdefaultZsh{} White background}
\PYGdefault{n}{y\PYGdefaultZus{}white} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}npy/ccd\PYGdefaultZus{}white\PYGdefaultZus{}00\PYGdefaultZus{}count.npy\PYGdefaultZdq{}}\PYGdefault{p}{)}
\PYGdefault{n}{notch} \PYGdefault{o}{=} \PYGdefault{n}{y\PYGdefaultZus{}white} \PYGdefault{o}{*} \PYGdefault{l+m+mf}{1.12} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{y}
\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{save}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}notch\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{notch}\PYGdefault{p}{)}
\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{save}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}x\PYGdefaultZus{}notch\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}notch}\PYGdefault{p}{)}

\PYGdefault{c}{\PYGdefaultZsh{} Background}
\PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}bg\PYGdefaultZus{}30\PYGdefaultZus{}10\PYGdefaultZdq{}}
\PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}data}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
\PYGdefault{n}{rate\PYGdefaultZus{}bg} \PYGdefault{o}{=} \PYGdefault{n}{y} \PYGdefault{o}{/} \PYGdefault{n}{t}
\PYGdefault{n}{rate\PYGdefaultZus{}bg\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{/} \PYGdefault{n}{t}
\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{save}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}rate\PYGdefaultZus{}bg\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{rate\PYGdefaultZus{}bg}\PYGdefault{p}{)}
\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{save}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}rate\PYGdefaultZus{}bg\PYGdefaultZus{}e\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{rate\PYGdefaultZus{}bg\PYGdefaultZus{}e}\PYGdefault{p}{)}

\PYGdefault{c}{\PYGdefaultZsh{} CS2}
\PYGdefault{n}{As} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{x0s} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{suffixes} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}\PYGdefaultZus{}notch\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}\PYGdefaultZus{}notch\PYGdefaultZus{}l2\PYGdefaultZsq{}}\PYGdefault{p}{]}
\PYGdefault{n}{labels} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}CS\PYGdefaultZdl{}\PYGdefaultZus{}2\PYGdefaultZdl{}, no \PYGdefaultZdl{}\PYGdefaultZbs{}lambda / 2\PYGdefaultZdl{}\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}CS\PYGdefaultZdl{}\PYGdefaultZus{}2\PYGdefaultZdl{}, \PYGdefaultZdl{}\PYGdefaultZbs{}lambda / 2\PYGdefaultZdl{}\PYGdefaultZsq{}}\PYGdefault{p}{]}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{suffix}\PYGdefault{p}{,} \PYGdefault{n}{label} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{suffixes}\PYGdefault{p}{,} \PYGdefault{n}{labels}\PYGdefault{p}{):}
    \PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}cs2\PYGdefaultZdq{}} \PYGdefault{o}{+} \PYGdefault{n}{suffix}
    \PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}rate}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
    \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{rm\PYGdefaultZus{}outliers}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{} Peak fit: Stokes 2,3, Anti\PYGdefaultZhy{}Stokes 2}
    \PYGdefault{n}{x\PYGdefaultZus{}ranges} \PYGdefault{o}{=} \PYGdefault{p}{[[}\PYGdefault{l+m+mi}{544}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{553}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{553}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{560}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{512}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{517}\PYGdefault{p}{]]}
    \PYGdefault{n}{p0s} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([[}\PYGdefault{l+m+mi}{551}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{10000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],[}\PYGdefault{l+m+mi}{555}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} 
                    \PYGdefault{p}{[}\PYGdefault{l+m+mi}{514}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{200}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{]])}
    \PYGdefault{k}{for} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0} \PYGdefault{o+ow}{in} \PYGdefault{n+nb}{zip}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}ranges}\PYGdefault{p}{,} \PYGdefault{n}{p0s}\PYGdefault{p}{):}
        \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak}\PYGdefault{p}{,} \PYGdefault{n}{c1} \PYGdefault{o}{=} \PYGdefault{n}{bw\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
        \PYGdefault{n}{x0s}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
        \PYGdefault{n}{As}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{])}
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{(}\PYGdefault{n}{x0s}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{reshape}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{3}\PYGdefault{p}{)}
\PYGdefault{n}{d\PYGdefaultZus{}lin} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}calibration.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} 
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{linear}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{d\PYGdefaultZus{}lin}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Integrate error on wavelength of CCD}
\PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sort}\PYGdefault{p}{(}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{mean}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{))} 
\PYGdefault{n}{lamb\PYGdefaultZus{}laser} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}lamb\PYGdefaultZus{}laser.npy\PYGdefaultZsq{}}\PYGdefault{p}{)[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}
\PYGdefault{n}{dnu} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}laser}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{7}
\PYGdefault{n}{lits} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+s}{\PYGdefaultZsq{}658\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}658\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}?\PYGdefaultZsq{}}\PYGdefault{p}{])} \PYGdefault{c}{\PYGdefaultZsh{} S, S, AS for CS2}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{,} \PYGdefault{n}{lit} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}mean}\PYGdefault{p}{,} \PYGdefault{n}{lamb\PYGdefaultZus{}to\PYGdefaultZus{}cm}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}mean}\PYGdefault{p}{),} \PYGdefault{n}{lits}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZbs{}cellcolor\PYGdefaultZob{}LightCyan\PYGdefaultZcb{}\PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{}   }\PYGdefault{l+s+se}{\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}
            \PYGdefault{n}{i}\PYGdefault{o}{+}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{x0}\PYGdefault{p}{),} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{),} \PYGdefault{n}{lit}\PYGdefault{p}{))}

\PYGdefault{c}{\PYGdefaultZsh{} CHCl\PYGdefaultZus{}3}
\PYGdefault{n}{As} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{x0s} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{suffixes} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}\PYGdefaultZus{}notch\PYGdefaultZus{}l2\PYGdefaultZsq{}}\PYGdefault{p}{]} \PYGdefault{c}{\PYGdefaultZsh{} peaks not visible for data without l2 plate}
\PYGdefault{n}{labels} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}CHCl\PYGdefaultZdl{}\PYGdefaultZus{}3\PYGdefaultZdl{}, \PYGdefaultZdl{}\PYGdefaultZbs{}lambda / 2\PYGdefaultZdl{}\PYGdefaultZsq{}}\PYGdefault{p}{]}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{suffix}\PYGdefault{p}{,} \PYGdefault{n}{label} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{suffixes}\PYGdefault{p}{,} \PYGdefault{n}{labels}\PYGdefault{p}{):}
    \PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}chcl3\PYGdefaultZdq{}} \PYGdefault{o}{+} \PYGdefault{n}{suffix}
    \PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}rate}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
    \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{rm\PYGdefaultZus{}outliers}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{} Peak fit: Stokes 1 \PYGdefaultZhy{} 4, Anti\PYGdefaultZhy{}Stokes 1, 2}
    \PYGdefault{n}{x\PYGdefaultZus{}ranges} \PYGdefault{o}{=} \PYGdefault{p}{[[}\PYGdefault{l+m+mi}{541}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{548}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{548}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{552.5}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{553}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{560}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{566}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{572}\PYGdefault{p}{],} 
                \PYGdefault{p}{[}\PYGdefault{l+m+mi}{519}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{523}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{512}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{516}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{509}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{512}\PYGdefault{p}{]]}
    \PYGdefault{n}{p0s} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([[}\PYGdefault{l+m+mi}{543}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{600}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mf}{551.5}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{600}\PYGdefault{p}{],} 
                    \PYGdefault{p}{[}\PYGdefault{l+m+mi}{554}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.4}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{700}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{600}\PYGdefault{p}{],}  \PYGdefault{p}{[}\PYGdefault{l+m+mi}{569}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.3}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{700}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{600}\PYGdefault{p}{],} 
                    \PYGdefault{p}{[}\PYGdefault{l+m+mi}{522}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.3}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{514}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.3}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{],} 
                    \PYGdefault{p}{[}\PYGdefault{l+m+mi}{511}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.3}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{]])}
    \PYGdefault{k}{for} \PYGdefault{n}{j}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}ranges}\PYGdefault{p}{,} \PYGdefault{n}{p0s}\PYGdefault{p}{):}
        \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak}\PYGdefault{p}{,} \PYGdefault{n}{c1} \PYGdefault{o}{=} \PYGdefault{n}{bw\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
        \PYGdefault{n}{x0s}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{ufloat}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}\PYGdefault{o}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]}\PYGdefault{o}{.}\PYGdefault{n}{n}\PYGdefault{p}{))}
        \PYGdefault{n}{As}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{])}
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sort}\PYGdefault{p}{(}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{(}\PYGdefault{n}{x0s}\PYGdefault{p}{))}
\PYGdefault{n}{d\PYGdefaultZus{}lin} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}calibration.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} 
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{linear}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{d\PYGdefaultZus{}lin}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Integrate error on wavelength of CCD}
\PYGdefault{n}{lamb\PYGdefaultZus{}laser} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}lamb\PYGdefaultZus{}laser.npy\PYGdefaultZsq{}}\PYGdefault{p}{)[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}
\PYGdefault{n}{dnu} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}laser}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{7} \PYGdefault{c}{\PYGdefaultZsh{} in cm\PYGdefaultZca{}\PYGdefaultZhy{}1}
\PYGdefault{n}{lits} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+m+mi}{774}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{680}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{366}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{366}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{680}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{774}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1220}\PYGdefault{p}{])} \PYGdefault{c}{\PYGdefaultZsh{} S, S, AS for CS2}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{,} \PYGdefault{n}{lit} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{n}{lamb\PYGdefaultZus{}to\PYGdefaultZus{}cm}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{),} \PYGdefault{n}{lits}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZbs{}cellcolor\PYGdefaultZob{}LightCyan\PYGdefaultZcb{}\PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZdl{}   }\PYGdefault{l+s+se}{\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}
            \PYGdefault{n}{i}\PYGdefault{o}{+}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{x0}\PYGdefault{p}{),} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{),} \PYGdefault{n}{lit}\PYGdefault{p}{))}

\PYGdefault{c}{\PYGdefaultZsh{} CCl4}
\PYGdefault{n}{As} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{x0s} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{corr0} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}corr0.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Correction factor for polarization}
\PYGdefault{n}{corr90} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}corr90.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Correction factor for polarization}
\PYGdefault{n}{suffixes} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}l2\PYGdefaultZus{}pol0\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}l2\PYGdefaultZus{}pol90\PYGdefaultZsq{}}\PYGdefault{p}{]}
\PYGdefault{n}{labels} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}CCl\PYGdefaultZdl{}\PYGdefaultZus{}4\PYGdefaultZdl{}, \PYGdefaultZdl{}0\PYGdefaultZca{}\PYGdefaultZbs{}circ \PYGdefaultZbs{}hat\PYGdefaultZob{}=\PYGdefaultZcb{} \PYGdefaultZbs{}perp\PYGdefaultZdl{} polarized\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}CCl\PYGdefaultZdl{}\PYGdefaultZus{}4\PYGdefaultZdl{}, \PYGdefaultZdl{}90\PYGdefaultZca{}\PYGdefaultZbs{}circ \PYGdefaultZbs{}hat\PYGdefaultZob{}=\PYGdefaultZcb{} \PYGdefaultZbs{}parallel\PYGdefaultZdl{} polarized\PYGdefaultZsq{}}\PYGdefault{p}{]}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{suffix}\PYGdefault{p}{,} \PYGdefault{n}{label} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{suffixes}\PYGdefault{p}{,} \PYGdefault{n}{labels}\PYGdefault{p}{):}
    \PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}ccl4\PYGdefaultZus{}\PYGdefaultZdq{}} \PYGdefault{o}{+} \PYGdefault{n}{suffix}
    \PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}rate}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{} Correction for polarization}
    \PYGdefault{k}{if} \PYGdefault{n}{suffix}\PYGdefault{p}{[}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{:]} \PYGdefault{o}{==} \PYGdefault{l+s}{\PYGdefaultZsq{}90\PYGdefaultZsq{}}\PYGdefault{p}{:}
        \PYGdefault{n}{corr} \PYGdefault{o}{=} \PYGdefault{n}{corr90}
    \PYGdefault{k}{else}\PYGdefault{p}{:}
        \PYGdefault{n}{corr} \PYGdefault{o}{=} \PYGdefault{n}{corr0}
    \PYGdefault{n}{y} \PYGdefault{o}{=} \PYGdefault{n}{corr} \PYGdefault{o}{*} \PYGdefault{n}{y}
    \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{corr} \PYGdefault{o}{*} \PYGdefault{n}{y\PYGdefaultZus{}e}  
    \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{rm\PYGdefaultZus{}outliers}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{5}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{} Peak fit: Stokes 1 \PYGdefaultZhy{} 3, Anti\PYGdefaultZhy{}Stokes 1, 2}
    \PYGdefault{n}{x\PYGdefaultZus{}ranges} \PYGdefault{o}{=} \PYGdefault{p}{[[}\PYGdefault{l+m+mi}{537}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{543}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{544}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{552}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{548}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{560}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{575}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{585}\PYGdefault{p}{],} 
                \PYGdefault{p}{[}\PYGdefault{l+m+mi}{520}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{526}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{514}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{520}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{507}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{516}\PYGdefault{p}{]]}
    \PYGdefault{n}{p0s} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([[}\PYGdefault{l+m+mi}{541}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{546}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],}
                    \PYGdefault{p}{[}\PYGdefault{l+m+mi}{555}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{400}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{579}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{60}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} 
                    \PYGdefault{p}{[}\PYGdefault{l+m+mi}{523}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{200}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{519}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{200}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} 
                    \PYGdefault{p}{[}\PYGdefault{l+m+mi}{511}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{30}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{]])}
    \PYGdefault{k}{for} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0} \PYGdefault{o+ow}{in} \PYGdefault{n+nb}{zip}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}ranges}\PYGdefault{p}{,} \PYGdefault{n}{p0s}\PYGdefault{p}{):}
        \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak}\PYGdefault{p}{,} \PYGdefault{n}{c1} \PYGdefault{o}{=} \PYGdefault{n}{bw\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
        \PYGdefault{n}{x0s}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{ufloat}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}\PYGdefault{o}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]}\PYGdefault{o}{.}\PYGdefault{n}{n}\PYGdefault{p}{))}
        \PYGdefault{n}{As}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{])}
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{(}\PYGdefault{n}{x0s}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{reshape}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{7}\PYGdefault{p}{)}
\PYGdefault{n}{d\PYGdefaultZus{}lin} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}calibration.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} 
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{linear}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{d\PYGdefaultZus{}lin}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Integrate error on wavelength of CCD}
\PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sort}\PYGdefault{p}{(}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{mean}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{))} 
\PYGdefault{n}{lamb\PYGdefaultZus{}laser} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}lamb\PYGdefaultZus{}laser.npy\PYGdefaultZsq{}}\PYGdefault{p}{)[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}
\PYGdefault{n}{dnu} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}laser}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{7}
\PYGdefault{n}{lits} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+s}{\PYGdefaultZsq{}776\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}459\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}314\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}314\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}459\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}776\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}?\PYGdefaultZsq{}}\PYGdefault{p}{])} \PYGdefault{c}{\PYGdefaultZsh{} S, S, S, AS, AS for CCl4}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{,} \PYGdefault{n}{lit} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}mean}\PYGdefault{p}{,} \PYGdefault{n}{lamb\PYGdefaultZus{}to\PYGdefaultZus{}cm}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}mean}\PYGdefault{p}{),} \PYGdefault{n}{lits}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZbs{}cellcolor\PYGdefaultZob{}LightCyan\PYGdefaultZcb{}\PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{}   }\PYGdefault{l+s+se}{\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}
            \PYGdefault{n}{i}\PYGdefault{o}{+}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{x0}\PYGdefault{p}{),} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{),} \PYGdefault{n}{lit}\PYGdefault{p}{))}
\PYGdefault{c}{\PYGdefaultZsh{} Intensity ratios:}
\PYGdefault{n}{I\PYGdefaultZus{}s} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{(}\PYGdefault{n}{As}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{reshape}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{7}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{T}\PYGdefault{p}{[[}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{3}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{3}\PYGdefault{p}{]]}\PYGdefault{o}{.}\PYGdefault{n}{T}
\PYGdefault{n}{I\PYGdefaultZus{}s} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{delete}\PYGdefault{p}{(}\PYGdefault{n}{I\PYGdefaultZus{}s}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Remove the value of the unknown peak!}
\PYGdefault{n}{rhos} \PYGdefault{o}{=} \PYGdefault{n}{I\PYGdefaultZus{}s}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{/} \PYGdefault{n}{I\PYGdefaultZus{}s}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]}
\PYGdefault{n}{rho\PYGdefaultZus{}lits} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+m+mf}{0.76}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.03}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.71}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.71}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.03}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.76}\PYGdefault{p}{]}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{ Depolarization\PYGdefaultZsq{}}\PYGdefault{p}{)}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{lit}\PYGdefault{p}{,} \PYGdefault{n}{Iperp}\PYGdefault{p}{,} \PYGdefault{n}{Ipara}\PYGdefault{p}{,} \PYGdefault{n}{rho}\PYGdefault{p}{,} \PYGdefault{n}{rho\PYGdefaultZus{}lit} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{lits}\PYGdefault{p}{[:}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{],} \PYGdefault{n}{I\PYGdefaultZus{}s}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{],}  \PYGdefault{n}{I\PYGdefaultZus{}s}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{],} \PYGdefault{n}{rhos}\PYGdefault{p}{,} \PYGdefault{n}{rho\PYGdefaultZus{}lits}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZbs{}cellcolor\PYGdefaultZob{}LightCyan\PYGdefaultZcb{}\PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}.2f}\PYGdefault{l+s}{\PYGdefaultZdl{} }\PYGdefault{l+s+se}{\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}
            \PYGdefault{n}{i}\PYGdefault{o}{+}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{lit}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{Iperp}\PYGdefault{p}{),} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{Ipara}\PYGdefault{p}{),} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{rho}\PYGdefault{p}{)} \PYGdefault{p}{,}\PYGdefault{n}{rho\PYGdefaultZus{}lit}\PYGdefault{p}{))}

\PYGdefault{c}{\PYGdefaultZsh{} Ethanol}
\PYGdefault{n}{As} \PYGdefault{o}{=} \PYGdefault{p}{[]}   
\PYGdefault{n}{x0s} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{two\PYGdefaultZus{}x0} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{concentration} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{10}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{20}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{30}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{40}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{60}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{70}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{80}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}orig\PYGdefaultZsq{}}\PYGdefault{p}{]}
\PYGdefault{n}{labels} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{n+nb}{str}\PYGdefault{p}{(}\PYGdefault{n}{conc}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+s}{r\PYGdefaultZsq{}\PYGdefaultZbs{}\PYGdefaultZpc{}\PYGdefaultZsq{}} \PYGdefault{k}{for} \PYGdefault{n}{conc} \PYGdefault{o+ow}{in} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{10}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{20}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{30}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{40}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{60}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{70}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{80}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{]]}  \PYGdefault{o}{+} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}original sample\PYGdefaultZsq{}}\PYGdefault{p}{]}
\PYGdefault{n}{corr} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}corr0.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Correction factor for polarization}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{conc\PYGdefaultZus{}i}\PYGdefault{p}{,} \PYGdefault{n}{label} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{concentration}\PYGdefault{p}{,} \PYGdefault{n}{labels}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{n+nb}{str}\PYGdefault{p}{(}\PYGdefault{n}{conc\PYGdefaultZus{}i}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{} e}\PYGdefault{l+s}{thanol\PYGdefaultZsq{}}\PYGdefault{p}{)}
    \PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}et\PYGdefaultZus{}\PYGdefaultZdq{}} \PYGdefault{o}{+} \PYGdefault{n+nb}{str}\PYGdefault{p}{(}\PYGdefault{n}{conc\PYGdefaultZus{}i}\PYGdefault{p}{)}
    \PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}rate}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{} Correction for polarization}
    \PYGdefault{n}{y} \PYGdefault{o}{=} \PYGdefault{n}{corr} \PYGdefault{o}{*} \PYGdefault{n}{y}
    \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{corr} \PYGdefault{o}{*} \PYGdefault{n}{y\PYGdefaultZus{}e}
    \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{rm\PYGdefaultZus{}outliers}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{4}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{} Flourescence: fit for 550 \PYGdefaultZhy{} 590 nm w/out peaks}
    \PYGdefault{n}{x\PYGdefaultZus{}peaks} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([[}\PYGdefault{l+m+mi}{556}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{560}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{562}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{566}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{569}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{572}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{574}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{580}\PYGdefault{p}{]])}
    \PYGdefault{n}{where\PYGdefaultZus{}peaks} \PYGdefault{o}{=} \PYGdefault{p}{[(}\PYGdefault{n}{x\PYGdefaultZus{}low} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{x}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{x} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{x\PYGdefaultZus{}high}\PYGdefault{p}{)} \PYGdefault{k}{for} \PYGdefault{n}{x\PYGdefaultZus{}low}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}high} \PYGdefault{o+ow}{in} \PYGdefault{n}{x\PYGdefaultZus{}peaks}\PYGdefault{p}{]}
    \PYGdefault{n}{mask\PYGdefaultZus{}no\PYGdefaultZus{}peak} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{where}\PYGdefault{p}{(}\PYGdefault{n+nb}{sum}\PYGdefault{p}{(}\PYGdefault{n}{where\PYGdefaultZus{}peaks}\PYGdefault{p}{)} \PYGdefault{o}{==} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}
    \PYGdefault{n}{x\PYGdefaultZus{}np} \PYGdefault{o}{=} \PYGdefault{n}{x}\PYGdefault{p}{[}\PYGdefault{n}{mask\PYGdefaultZus{}no\PYGdefaultZus{}peak}\PYGdefault{p}{]}
    \PYGdefault{n}{y\PYGdefaultZus{}np} \PYGdefault{o}{=} \PYGdefault{n}{y}\PYGdefault{p}{[}\PYGdefault{n}{mask\PYGdefaultZus{}no\PYGdefaultZus{}peak}\PYGdefault{p}{]}
    \PYGdefault{n}{y\PYGdefaultZus{}np\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{[}\PYGdefault{n}{mask\PYGdefaultZus{}no\PYGdefaultZus{}peak}\PYGdefault{p}{]}
    \PYGdefault{n}{x\PYGdefaultZus{}range\PYGdefaultZus{}poly} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{550}\PYGdefault{p}{,}  \PYGdefault{l+m+mi}{610}\PYGdefault{p}{]} \PYGdefault{c}{\PYGdefaultZsh{} reduce range for polyfit}
    \PYGdefault{n}{p0} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
    \PYGdefault{n}{p} \PYGdefault{o}{=}  \PYGdefault{n}{poly\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}np}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}np\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range\PYGdefaultZus{}poly}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{)}
    \PYGdefault{n}{p\PYGdefaultZus{}n} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{nominal\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{p}\PYGdefault{p}{)}
    \PYGdefault{n}{x\PYGdefaultZus{}poly} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{linspace}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}range\PYGdefaultZus{}poly}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} \PYGdefault{n}{x\PYGdefaultZus{}range\PYGdefaultZus{}poly}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{],} \PYGdefault{l+m+mi}{200}\PYGdefault{p}{)}
    \PYGdefault{n}{y\PYGdefaultZus{}poly} \PYGdefault{o}{=} \PYGdefault{n}{poly}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}poly}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{p\PYGdefaultZus{}n}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{} Peak fit: Data \PYGdefaultZhy{} flourescence}
    \PYGdefault{n}{y\PYGdefaultZus{}fit} \PYGdefault{o}{=} \PYGdefault{n}{y} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{poly}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{p\PYGdefaultZus{}n}\PYGdefault{p}{)}
    \PYGdefault{n}{y\PYGdefaultZus{}fit\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{poly}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{p}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{} Peak fit: Stokes 2,3, Anti\PYGdefaultZhy{}Stokes 2}
    \PYGdefault{n}{x\PYGdefaultZus{}ranges} \PYGdefault{o}{=} \PYGdefault{p}{[[}\PYGdefault{l+m+mi}{554}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{561}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{569}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{573}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{573}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{580}\PYGdefault{p}{]]}
    \PYGdefault{n}{p0s} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([[}\PYGdefault{l+m+mi}{558}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{571}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{50}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} 
                    \PYGdefault{p}{[}\PYGdefault{l+m+mi}{577}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{50}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{]])}
    \PYGdefault{k}{for} \PYGdefault{n}{j}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}ranges}\PYGdefault{p}{,} \PYGdefault{n}{p0s}\PYGdefault{p}{):}
        \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak}\PYGdefault{p}{,} \PYGdefault{n}{c1} \PYGdefault{o}{=} \PYGdefault{n}{bw\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}fit\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
        \PYGdefault{n}{As}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{])}
        \PYGdefault{n}{x0s}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
    \PYGdefault{c}{\PYGdefaultZsh{} double peak}
    \PYGdefault{n}{x\PYGdefaultZus{}range\PYGdefaultZus{}two} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{562}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{566}\PYGdefault{p}{]}
    \PYGdefault{n}{p0\PYGdefaultZus{}two} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+m+mi}{563}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{565}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
    \PYGdefault{n}{x\PYGdefaultZus{}fit2}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak2}\PYGdefault{p}{,} \PYGdefault{n}{c2} \PYGdefault{o}{=} \PYGdefault{n}{two\PYGdefaultZus{}bw\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}fit\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range\PYGdefaultZus{}two}\PYGdefault{p}{,} \PYGdefault{n}{p0\PYGdefaultZus{}two}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
    \PYGdefault{n}{x0s}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c2}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
    \PYGdefault{n}{x0s}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c2}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{3}\PYGdefault{p}{])}
    \PYGdefault{n}{As}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c2}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{])}
    \PYGdefault{n}{As}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c2}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{5}\PYGdefault{p}{])}
\PYGdefault{c}{\PYGdefaultZsh{} Linear fit on ethanol percentage}
\PYGdefault{k+kn}{from} \PYGdefault{n+nn}{scipy.odr} \PYGdefault{k+kn}{import} \PYGdefault{n}{ODR}\PYGdefault{p}{,} \PYGdefault{n}{Model}\PYGdefault{p}{,} \PYGdefault{n}{Data}\PYGdefault{p}{,} \PYGdefault{n}{RealData}
\PYGdefault{k}{def} \PYGdefault{n+nf}{func}\PYGdefault{p}{(}\PYGdefault{n}{beta}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{):}
    \PYGdefault{n}{y} \PYGdefault{o}{=} \PYGdefault{n}{beta}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{beta}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{x}
    \PYGdefault{k}{return} \PYGdefault{n}{y}
\PYGdefault{k}{def} \PYGdefault{n+nf}{linear\PYGdefaultZus{}beta}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{beta\PYGdefaultZus{}0}\PYGdefault{p}{,} \PYGdefault{n}{beta\PYGdefaultZus{}1}\PYGdefault{p}{):}
    \PYGdefault{k}{return} \PYGdefault{n}{beta\PYGdefaultZus{}0} \PYGdefault{o}{+} \PYGdefault{n}{beta\PYGdefaultZus{}1} \PYGdefault{o}{*} \PYGdefault{n}{x}
\PYGdefault{n}{intensity} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{(}\PYGdefault{n}{As}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{reshape}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{9}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{5}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{T}\PYGdefault{p}{[[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{3}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{4}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2}\PYGdefault{p}{]]}\PYGdefault{o}{.}\PYGdefault{n}{T} \PYGdefault{c}{\PYGdefaultZsh{} move peak 2 \PYGdefaultZam{} 3 to the correct position}
\PYGdefault{n}{A\PYGdefaultZus{}lambda} \PYGdefault{o}{=} \PYGdefault{n}{intensity}\PYGdefault{p}{[:}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]}\PYGdefault{o}{.}\PYGdefault{n}{T} \PYGdefault{c}{\PYGdefaultZsh{} entries of each peak put together}
\PYGdefault{n}{peaks} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}558.3\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}563.5\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}564.7\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}570.8\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}576.7\PYGdefaultZsq{}}\PYGdefault{p}{]}
\PYGdefault{n}{intersects} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{x} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{(}\PYGdefault{n}{concentration}\PYGdefault{p}{[:}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])}
\PYGdefault{n}{sx} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{4}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{peak}\PYGdefault{p}{,} \PYGdefault{n}{A} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{peaks}\PYGdefault{p}{,} \PYGdefault{n}{A\PYGdefaultZus{}lambda}\PYGdefault{p}{):}
    \PYGdefault{n}{y} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{nominal\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{)}
    \PYGdefault{n}{sy} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{std\PYGdefaultZus{}devs}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{)}
    \PYGdefault{n}{data} \PYGdefault{o}{=} \PYGdefault{n}{RealData}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{sx}\PYGdefault{o}{=}\PYGdefault{n}{sx}\PYGdefault{p}{,} \PYGdefault{n}{sy}\PYGdefault{o}{=}\PYGdefault{n}{sy}\PYGdefault{p}{)}
    \PYGdefault{n}{model} \PYGdefault{o}{=} \PYGdefault{n}{Model}\PYGdefault{p}{(}\PYGdefault{n}{func}\PYGdefault{p}{)}
    \PYGdefault{n}{odr} \PYGdefault{o}{=} \PYGdefault{n}{ODR}\PYGdefault{p}{(}\PYGdefault{n}{data}\PYGdefault{p}{,} \PYGdefault{n}{model}\PYGdefault{p}{,} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{6}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
    \PYGdefault{n}{odr}\PYGdefault{o}{.}\PYGdefault{n}{set\PYGdefaultZus{}job}\PYGdefault{p}{(}\PYGdefault{n}{fit\PYGdefaultZus{}type}\PYGdefault{o}{=}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{)}
    \PYGdefault{n}{output} \PYGdefault{o}{=} \PYGdefault{n}{odr}\PYGdefault{o}{.}\PYGdefault{n}{run}\PYGdefault{p}{()}
    \PYGdefault{n}{beta} \PYGdefault{o}{=} \PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{correlated\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{output}\PYGdefault{o}{.}\PYGdefault{n}{beta}\PYGdefault{p}{,} \PYGdefault{n}{output}\PYGdefault{o}{.}\PYGdefault{n}{cov\PYGdefaultZus{}beta}\PYGdefault{p}{)}
    \PYGdefault{n}{fit} \PYGdefault{o}{=} \PYGdefault{n}{linear\PYGdefaultZus{}beta}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{beta}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{}Intersects}
    \PYGdefault{n}{y0} \PYGdefault{o}{=} \PYGdefault{n}{intensity}\PYGdefault{p}{[}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{][}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{c}{\PYGdefaultZsh{} peak intensities of the original sample}
    \PYGdefault{n}{x0} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{y0} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{beta}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{])} \PYGdefault{o}{/} \PYGdefault{n}{beta}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]}
    \PYGdefault{n}{intersects}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{x0}\PYGdefault{p}{)}
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{(}\PYGdefault{n}{x0s}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{reshape}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{9}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{5}\PYGdefault{p}{)}
\PYGdefault{n}{d\PYGdefaultZus{}lin} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}calibration.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} 
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{linear}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{d\PYGdefaultZus{}lin}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Integrate error on wavelength of CCD}
\PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{mean}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)} 
\PYGdefault{n}{lamb\PYGdefaultZus{}laser} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}lamb\PYGdefaultZus{}laser.npy\PYGdefaultZsq{}}\PYGdefault{p}{)[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}
\PYGdefault{n}{dnu} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}laser}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{7}
\PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sort}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}mean}\PYGdefault{p}{)}
\PYGdefault{n}{lits} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+m+mi}{888}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1028}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1091}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1274}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1464}\PYGdefault{p}{])} 
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{,} \PYGdefault{n}{lit}\PYGdefault{p}{,}\PYGdefault{n}{intersect} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}mean}\PYGdefault{p}{,} \PYGdefault{n}{lamb\PYGdefaultZus{}to\PYGdefaultZus{}cm}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}mean}\PYGdefault{p}{),} \PYGdefault{n}{lits}\PYGdefault{p}{,} \PYGdefault{n}{intersects}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZbs{}cellcolor\PYGdefaultZob{}LightCyan\PYGdefaultZcb{}\PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{}  }\PYGdefault{l+s+se}{\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}
            \PYGdefault{n}{i}\PYGdefault{o}{+}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{x0}\PYGdefault{p}{),} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{),} \PYGdefault{n}{lit}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{intersect}\PYGdefault{p}{)))}
\PYGdefault{c}{\PYGdefaultZsh{} Ethanol concentration in the unknown original sample.}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{ Ethanol concentration of unknown sample: \PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{mean}\PYGdefault{p}{(}\PYGdefault{n}{intersects}\PYGdefault{p}{)))}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}Standard deviation: \PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{std}\PYGdefault{p}{(}\PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{nominal\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{intersects}\PYGdefault{p}{)))}

\PYGdefault{c}{\PYGdefaultZsh{} Sulfur spectrum \PYGdefaultZhy{} Temperatur measurement}
\PYGdefault{n}{corr} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}corr0.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Correction factor for polarization}
\PYGdefault{n}{I\PYGdefaultZus{}laser\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{70}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{80}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{90}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{100}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{110}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{120}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{130}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{140}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{150}\PYGdefault{p}{]}
\PYGdefault{n}{labels} \PYGdefault{o}{=} \PYGdefault{p}{[}\PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}.2f}\PYGdefault{l+s}{ A\PYGdefaultZsq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}\PYGdefault{n}{I\PYGdefaultZus{}l} \PYGdefault{o}{*} \PYGdefault{l+m+mf}{0.01}\PYGdefault{p}{)} \PYGdefault{k}{for} \PYGdefault{n}{I\PYGdefaultZus{}l} \PYGdefault{o+ow}{in} \PYGdefault{n}{I\PYGdefaultZus{}laser\PYGdefaultZus{}all}\PYGdefault{p}{]}
\PYGdefault{n}{x0s} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{n}{As} \PYGdefault{o}{=} \PYGdefault{p}{[]}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}Calculate temperature\PYGdefaultZsq{}}\PYGdefault{p}{)}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{I\PYGdefaultZus{}laser}\PYGdefault{p}{,} \PYGdefault{n}{label} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{I\PYGdefaultZus{}laser\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{n}{labels}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{n}{label}\PYGdefault{p}{)}
    \PYGdefault{n}{filename} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}ccd\PYGdefaultZus{}s\PYGdefaultZus{}\PYGdefaultZdq{}} \PYGdefault{o}{+} \PYGdefault{n+nb}{str}\PYGdefault{p}{(}\PYGdefault{n}{I\PYGdefaultZus{}laser}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{zfill}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{3}\PYGdefault{p}{)}
    \PYGdefault{n}{t}\PYGdefault{p}{,} \PYGdefault{n}{avg}\PYGdefault{p}{,} \PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{get\PYGdefaultZus{}ccd\PYGdefaultZus{}rate}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{)}
    \PYGdefault{c}{\PYGdefaultZsh{} Correction for polarization}
    \PYGdefault{n}{y} \PYGdefault{o}{=} \PYGdefault{n}{corr} \PYGdefault{o}{*} \PYGdefault{n}{y}
    \PYGdefault{n}{y\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{corr} \PYGdefault{o}{*} \PYGdefault{n}{y\PYGdefaultZus{}e}
    \PYGdefault{n}{x\PYGdefaultZus{}ranges} \PYGdefault{o}{=} \PYGdefault{p}{[[}\PYGdefault{l+m+mi}{545}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{549}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{510}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{519}\PYGdefault{p}{]]}
    \PYGdefault{n}{p0s} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([[}\PYGdefault{l+m+mf}{545.5}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{20000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{3500}\PYGdefault{p}{],} \PYGdefault{p}{[}\PYGdefault{l+m+mi}{518}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.2}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{5000}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{200}\PYGdefault{p}{]])}
    \PYGdefault{k}{for} \PYGdefault{n}{j}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{x\PYGdefaultZus{}ranges}\PYGdefault{p}{,} \PYGdefault{n}{p0s}\PYGdefault{p}{):}
        \PYGdefault{n}{x\PYGdefaultZus{}fit}\PYGdefault{p}{,} \PYGdefault{n}{fit\PYGdefaultZus{}peak}\PYGdefault{p}{,} \PYGdefault{n}{c1} \PYGdefault{o}{=} \PYGdefault{n}{bw\PYGdefaultZus{}fit}\PYGdefault{p}{(}\PYGdefault{n}{x}\PYGdefault{p}{,} \PYGdefault{n}{y\PYGdefaultZus{}e}\PYGdefault{p}{,} \PYGdefault{n}{x\PYGdefaultZus{}range}\PYGdefault{p}{,} \PYGdefault{n}{p0}\PYGdefault{p}{,} \PYGdefault{n}{fit}\PYGdefault{o}{=}\PYGdefault{n+nb+bp}{True}\PYGdefault{p}{)}
        \PYGdefault{n}{x0s}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{])}
        \PYGdefault{n}{As}\PYGdefault{o}{.}\PYGdefault{n}{append}\PYGdefault{p}{(}\PYGdefault{n}{c1}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{])}
\PYGdefault{c}{\PYGdefaultZsh{} Intensity ratio}
\PYGdefault{n}{intensities} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{(}\PYGdefault{n}{As}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{reshape}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{9}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{T} \PYGdefault{c}{\PYGdefaultZsh{} stokes and anti\PYGdefaultZhy{}stokes}
\PYGdefault{n}{A\PYGdefaultZus{}ratio} \PYGdefault{o}{=} \PYGdefault{n}{intensities}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{/} \PYGdefault{n}{intensities}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}
\PYGdefault{n}{y} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{nominal\PYGdefaultZus{}values}\PYGdefault{p}{(}\PYGdefault{n}{A\PYGdefaultZus{}ratio}\PYGdefault{p}{)}
\PYGdefault{n}{sy} \PYGdefault{o}{=} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{std\PYGdefaultZus{}devs}\PYGdefault{p}{(}\PYGdefault{n}{A\PYGdefaultZus{}ratio}\PYGdefault{p}{)}
\PYGdefault{n}{mean\PYGdefaultZus{}ratio} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{mean}\PYGdefault{p}{(}\PYGdefault{n}{y}\PYGdefault{p}{)}
\PYGdefault{n}{std\PYGdefaultZus{}ratio} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{std}\PYGdefault{p}{(}\PYGdefault{n}{y}\PYGdefault{p}{)}
\PYGdefault{n}{mean\PYGdefaultZus{}ratio\PYGdefaultZus{}e} \PYGdefault{o}{=} \PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{ufloat}\PYGdefault{p}{(}\PYGdefault{n}{mean\PYGdefaultZus{}ratio}\PYGdefault{p}{,} \PYGdefault{n}{std\PYGdefaultZus{}ratio}\PYGdefault{p}{)}
\PYGdefault{k}{for} \PYGdefault{n}{I\PYGdefaultZus{}l}\PYGdefault{p}{,} \PYGdefault{n}{Is}\PYGdefault{p}{,} \PYGdefault{n}{Ias}\PYGdefault{p}{,} \PYGdefault{n}{A\PYGdefaultZus{}rat} \PYGdefault{o+ow}{in} \PYGdefault{n+nb}{zip}\PYGdefault{p}{(}\PYGdefault{n}{labels}\PYGdefault{p}{,} \PYGdefault{n}{intensities}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{],} \PYGdefault{n}{intensities}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{],} \PYGdefault{n}{A\PYGdefaultZus{}ratio}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZbs{}cellcolor\PYGdefaultZob{}LightCyan\PYGdefaultZcb{}\PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} A \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{}   }\PYGdefault{l+s+se}{\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}
            \PYGdefault{n}{I\PYGdefaultZus{}l}\PYGdefault{p}{[:}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{],} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{Is}\PYGdefault{p}{),} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{Ias}\PYGdefault{p}{),} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{A\PYGdefaultZus{}rat}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{5}\PYGdefault{p}{)))}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{p}{)}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}Mean intensity ratio: \PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{uc}\PYGdefault{o}{.}\PYGdefault{n}{ufloat}\PYGdefault{p}{(}\PYGdefault{n}{mean\PYGdefaultZus{}ratio}\PYGdefault{p}{,} \PYGdefault{n}{std\PYGdefaultZus{}ratio}\PYGdefault{p}{)))}
\PYGdefault{c}{\PYGdefaultZsh{} Print latex table of wavenumbers}
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{(}\PYGdefault{n}{x0s}\PYGdefault{p}{)}\PYGdefault{o}{.}\PYGdefault{n}{reshape}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{9}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2}\PYGdefault{p}{)}
\PYGdefault{n}{d\PYGdefaultZus{}lin} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}calibration.npy\PYGdefaultZsq{}}\PYGdefault{p}{)} 
\PYGdefault{n}{lamb\PYGdefaultZus{}all} \PYGdefault{o}{=} \PYGdefault{n}{linear}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{o}{*}\PYGdefault{n}{d\PYGdefaultZus{}lin}\PYGdefault{p}{)} \PYGdefault{c}{\PYGdefaultZsh{} Integrate error on wavelength of CCD}
\PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{mean}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}all}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)} 
\PYGdefault{n}{lamb\PYGdefaultZus{}laser} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{load}\PYGdefault{p}{(}\PYGdefault{n}{npy\PYGdefaultZus{}dir} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{}ccd\PYGdefaultZus{}lamb\PYGdefaultZus{}laser.npy\PYGdefaultZsq{}}\PYGdefault{p}{)[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}
\PYGdefault{n}{dnu} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}laser}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{7}
\PYGdefault{n}{lits} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{l+s}{\PYGdefaultZsq{}bla\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZsq{}blub\PYGdefaultZsq{}}\PYGdefault{p}{])} \PYGdefault{c}{\PYGdefaultZsh{} S, S, S, AS, AS for CCl4}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{ Wavenumbers of both peaks:\PYGdefaultZsq{}}\PYGdefault{p}{)}
\PYGdefault{k}{for} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{x0}\PYGdefault{p}{,} \PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{,} \PYGdefault{n}{lit} \PYGdefault{o+ow}{in} \PYGdefault{n}{enum}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}mean}\PYGdefault{p}{,} \PYGdefault{n}{lamb\PYGdefaultZus{}to\PYGdefaultZus{}cm}\PYGdefault{p}{(}\PYGdefault{n}{lamb\PYGdefaultZus{}mean}\PYGdefault{p}{),} \PYGdefault{n}{lits}\PYGdefault{p}{):}
    \PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZbs{}cellcolor\PYGdefaultZob{}LightCyan\PYGdefaultZcb{}\PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}i}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{} \PYGdefaultZam{} \PYGdefaultZdl{}}\PYGdefault{l+s+si}{\PYGdefaultZpc{}s}\PYGdefault{l+s}{\PYGdefaultZdl{}   }\PYGdefault{l+s+se}{\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}\PYGdefaultZbs{}}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{o}{\PYGdefaultZpc{}}\PYGdefault{p}{(}
            \PYGdefault{n}{i}\PYGdefault{o}{+}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{x0}\PYGdefault{p}{),} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{dnu\PYGdefaultZus{}cm}\PYGdefault{p}{),} \PYGdefault{n}{lit}\PYGdefault{p}{))}
\PYGdefault{c}{\PYGdefaultZsh{} Calculation of temperature (uses SI units!)}
\PYGdefault{k+kn}{from} \PYGdefault{n+nn}{scipy.constants} \PYGdefault{k+kn}{import} \PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{c}\PYGdefault{p}{,} \PYGdefault{n}{h}
\PYGdefault{n}{nu\PYGdefaultZus{}l\PYGdefaultZus{}si} \PYGdefault{o}{=} \PYGdefault{n}{c} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}laser}
\PYGdefault{n}{dnu\PYGdefaultZus{}si} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{mean}\PYGdefault{p}{(}\PYGdefault{n+nb}{abs}\PYGdefault{p}{(}\PYGdefault{n}{c} \PYGdefault{o}{/} \PYGdefault{n}{lamb\PYGdefaultZus{}mean} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{nu\PYGdefaultZus{}l\PYGdefaultZus{}si}\PYGdefault{p}{))} \PYGdefault{c}{\PYGdefaultZsh{} in Hz!!!}
\PYGdefault{n}{T} \PYGdefault{o}{=} \PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{p}{(}\PYGdefault{n}{h} \PYGdefault{o}{*} \PYGdefault{n}{dnu\PYGdefaultZus{}si} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{9}\PYGdefault{p}{)} \PYGdefault{o}{/} \PYGdefault{p}{(}\PYGdefault{n}{k} \PYGdefault{o}{*} \PYGdefault{n}{un}\PYGdefault{o}{.}\PYGdefault{n}{log}\PYGdefault{p}{(}\PYGdefault{n}{mean\PYGdefaultZus{}ratio\PYGdefaultZus{}e} \PYGdefault{o}{*} \PYGdefault{p}{((}\PYGdefault{n}{nu\PYGdefaultZus{}l\PYGdefaultZus{}si} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{dnu\PYGdefaultZus{}si}\PYGdefault{p}{)} \PYGdefault{o}{/} \PYGdefault{p}{(}\PYGdefault{n}{nu\PYGdefaultZus{}l\PYGdefaultZus{}si} \PYGdefault{o}{+} \PYGdefault{n}{dnu\PYGdefaultZus{}si}\PYGdefault{p}{))}\PYGdefault{o}{**}\PYGdefault{l+m+mi}{4}\PYGdefault{p}{))}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZbs{}Delta }\PYGdefault{l+s+se}{\PYGdefaultZbs{}\PYGdefaultZbs{}}\PYGdefault{l+s}{nu = \PYGdefaultZsq{}} \PYGdefault{o}{+} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{dnu\PYGdefaultZus{}si} \PYGdefault{o}{*} \PYGdefault{l+m+mi}{10}\PYGdefault{o}{**\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{} Hz\PYGdefaultZsq{}}\PYGdefault{p}{)}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}Temperatur T = \PYGdefaultZsq{}} \PYGdefault{o}{+} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{T}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{} K\PYGdefaultZsq{}}\PYGdefault{p}{)}
\PYGdefault{k}{print}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZsq{}Temperatur T = \PYGdefaultZsq{}} \PYGdefault{o}{+} \PYGdefault{n}{uc\PYGdefaultZus{}str}\PYGdefault{p}{(}\PYGdefault{n}{T} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mf}{273.15}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+s}{\PYGdefaultZsq{} \PYGdefaultZca{}\PYGdefaultZbs{}circ C\PYGdefaultZsq{}}\PYGdefault{p}{)}
\end{Verbatim}
